<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="cn.batchfile.stat.server.dao.GcDao" >

	<resultMap id="gcResult" type="Gc">
		<result property="commandId" column="command_id"/>
		<result property="agentId" column="agent_id"/>
		<result property="pid" column="pid"/>
		<result property="beginTime" column="begin_time"/>
		<result property="status" column="status"/>
		<result property="name" column="name"/>
	</resultMap>
	
	<insert id="insertGc" parameterType="Gc">
		REPLACE INTO `gc` 
		(`command_id`,`agent_id`,`pid`,`begin_time`,`status`,`name`) 
		VALUES 
		(#{commandId},#{agentId},#{pid},#{beginTime},#{status},#{name})
	</insert>
	
	<select id="getRunningGcs" resultMap="gcResult">
		SELECT * FROM `gc` WHERE `status`='running'
	</select>

	<update id="updateGcStatus" parameterType="Gc">
		UPDATE `gc` SET `status`=#{status} WHERE `command_id`=#{commandId}
	</update>

	<insert id="insertGcData" parameterType="GcData">
		REPLACE INTO `gc_data` 
		(`command_id`,`time`,`agent_id`,`pid`,
		`s0c`,`s1c`,`s0u`,`s1u`,`ec`,`eu`,`oc`,`ou`,`mc`,`mu`,
		`ccsc`,`ccsu`,`ygc`,`ygct`,`fgc`,`fgct`,`gct`) 
		VALUES 
		(#{commandId},#{time},#{agentId},#{pid},
		#{s0c},#{s1c},#{s0u},#{s1u},#{ec},#{eu},#{oc},#{ou},#{mc},#{mu},
		#{ccsc},#{ccsu},#{ygc},#{ygct},#{fgc},#{fgct},#{gct})
	</insert>

</mapper>